DreamJs开发框架
========
### 起源 ###

在flash王朝轰然倒下后，页游开发进入了战国时代，开发者也随之被分成很多流派，走上了各自的发展道路。

主流框架各有千秋，竞争非常激烈，一旦择之不慎，会造成极其被动的局面，而更换开发框架绝对是一件另人头痛的事。

DreamJs应运而生，它的目的是统一前端开发，让开发者重新掌握主动权。它巧妙的双层结构，是实现这一宏伟目标的钥匙。

### 原理 ###

虽然各大框架功能繁多，但其核心无不集中在图形渲染上。对于2D游戏来说，最主流的结构是创造一个图形精灵，然后在上面扩展出上层显示结构。

如果用各框架封装出相同的图形精灵，对接到公共的上层显示结构上，组合成容器、图片、文本、按钮和其他组件，再配备时间管理、触摸事件和声音控制等，就能开发出统一的应用程序了。

至于3D功能，目前不强求统一，从逻辑上把其视为2D体系的一个空白容器，直接调用下层接口使用即可。

DreamJs肯定做不到大而全，让所有人都满意的框架是不存在的。不过由于它的结构简单，分类合理，代码量较少，所以是一个改得动的框架。开发者可以对底层进行任何程度的改动，使之符合自己的需要。

### 价值 ###

由于目标宏伟，所以必须简单。正因为简单，所以非常适合新手入门。

DreamJs是一个轻量级的框架，它遵循了顺势而为的原则，并不阻止对下层接口的访问，所以它是对于下层框架的加成。在程序员换工作时，就能选择到更多不同开发框架的公司就职，直接上岗干活出成果。

对于开发团队来说，如果有一种新的开发框架崛起了，不用紧张，无需放弃原有开发习惯推倒重来，而是快速切入过去。

对于网页和微信小程序这种非游戏类平台，也轻松实现了对接。管你是游戏还是应用，一套规则打遍天下。

### 下层对接 ###

对接下层框架比想象的要简单得多，实际上只需做两件事就可以了。

一是生成图形精灵类，这是一个容器对象，具有位置大小等属性，还能在里面绘图和显示文字。各下层框架里一般都有对应的对象，对于dom是div，对于Laya来说是Laya.Sprite，我们需要对其进行改造，扩展出相同的接口。

二是提供一个顶级精灵容器，用于添加上层舞台对象。

在对接好之后，无需上层架构，就已经可以用相同代码实现一些原始功能了。

```typescript
<script src="js/core-dom.js"></script>
<script>
var sprite=new Sprite();
sprite.width=sprite.height=100;
sprite.setBgColor("#00d000");
Core.root.addChild(sprite);
</script>
```

### 上层框架 ###

有了下层提供的图形精灵，之后的故事就发生在上层世界里了。

上层开发规则继承自flash老大哥的优良传统，与LayaBox尤其神似，尽量减少开发者的入门成本。

下面是上层框架提供的功能，虽然简单，但都是大浪淘沙保留下来的，足以用于独立游戏开发。在适当扩展后，也能用于团队开发项目之中。

![1.png]

### 开发环境 ###

1.编写web程序，vscode是我们的不二选择。它推出后，天下为之一振，很快终结了持续多年的编辑器之争。

[到官网下载vscode](https://code.visualstudio.com)

2.Electron结合了Chromium和NodeJs，让web程序真正具有桌面应用功能，加持到vscode上，效果让人叫绝。

[下载Electron(win)](http://dreamjs8.com/downloads/electron-win.zip) (58.12M)

[下载Electron(mac)](http://dreamjs8.com/downloads/electron-mac.zip) (48.27M)

3.下载任意游戏项目到本地，然后用vscode打开。

4.编辑项目中的.vscode/launch.json，设置正确的Electron运行包路径。

```typescript
//windows系统
{"runtimeExecutable":"右键属性拷贝路径/electron-win/electron.exe"}
//mac系统
{"runtimeExecutable":"右键属性拷贝路径/electron-mac/.bin/electron"}
```

5.执行菜单Debug->Start Debugging，就能看到运行结果了。

### Hello,world! ###

DreamJs用于开源的默认项目是经典的打飞机，稍微改一下构造函数，让你的程序发出第一声呐喊吧！

```typescript
class Main extends Box{
    public static aspect=1;
    constructor(){
        super();
        var label=new Label();
        this.addChild(label);
        label.fontSize=50;
        label.color="#00c000";
        label.text="Hello,World!";
        label.setPos(100,100);
    }
}
```

### 如何深入 ###

虽然DreamJs的开发规则简单，但并不代表着你能轻易地把任意游戏开发出来，这需要大量的学习和实践。

最现成的方法莫过于学习官网上的案例了，2048，俄罗斯方块，连连看，哪个不是响当当的经典。而且都经过反复打磨，功能完整，代码简洁，具有相当实用性，适当扩展即可上线，吃透了绝对另人特有成就感。

喜欢研究底层的程序员，可以自己对接新的下层框架，对上层规则进行扩展，让DreamJs变得更加强大。

如果DreamJs能吸引住你的目光，非常欢迎加入我们的微信开发群大家庭~

### 作者 ###

呢称：兴祥

兴趣：将前端代码简化到底

微信：flashxcom